<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Hawkular Chart Tester</title>
  <meta name="description"
        content="Hawkular Charts Standalone Chart Example. An example how to use the hawkular-charts in a sample page.">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/hawkular-charts.css">
  <style>
    .metricIdLabel {
      color: #1008a9;
    }

    .metricIdHeader {
      margin: 20px 0 -35px 90px;
    }

    .metricIdHeader > li {
      margin-left: 40px;
    }

    .chartWrapper {
      height: 250px;
    }
  </style>

  <!-- build:js scripts/vendor.js -->
  <!-- bower:js -->
  <script src="libs/jquery/dist/jquery.js"></script>
  <script src="libs/angular/angular.js"></script>
  <script src="libs/d3/d3.js"></script>
  <script src="libs/moment/moment.js"></script>
  <script src="libs/d3-tip/index.js"></script>
  <!-- endbower -->
  <!-- endbuild -->

  <!-- build:js({.tmp,app}) scripts/scripts.js -->
  <!-- endbuild -->


  <script>
    var app = angular.module('myApp', ['hawkular.charts']);

    app.controller('ChartController', function ($scope) {

      // set the alert threshold to whatever
      $scope.alertThreshold = 2000;
      $scope.dataPoints = 120;
      $scope.hideHighLowValues = false;

      // load a captured Hawkular Feed for sample data -- simulates loading data
      $.getJSON('./test-data/metrics-data.json', function (jsonData) {

        $scope.originalData = jsonData;
        $scope.myData = jsonData;

        // this is simply a d3 function to return the beginning and ending values
        var myTimeRange = d3.extent($scope.myData, function (value) {
          return value.timestamp;
        });

        // set our initial timerange based on the data bounds
        $scope.startTimestamp = myTimeRange[0];
        $scope.endTimestamp = myTimeRange[1];
        console.info('Starting time range values: ' + new Date(myTimeRange[0]) + ' - ' + new Date(myTimeRange[1]));
        $scope.refreshChartWithDateRange();

      });

      $scope.$watch('dataPoints', function (dataPoints) {
        if (dataPoints && $scope.originalData) {
          console.log('dataPoints changed to: '+dataPoints);
          $scope.myData = $scope.originalData.slice(0, dataPoints);
        }
      });

      $scope.refreshChartWithDateRange = function () {
        console.info('RefreshChart');
        // we already have the data, but perhaps the data is stale and you want to requery
        // also, by just changing the data the charts will automatically update themselves
        $scope.myData = $scope.myData.filter(function (value) {
          return value.timestamp >= $scope.startTimestamp && value.timestamp <= $scope.endTimestamp;
        });
        $scope.$digest();

      };

      $scope.$on('ChartTimeRangeChanged', function (event, data) {
        console.info('Received ChartTimeRangeChanged: ' + data[0] + ' - ' + data[1]);
        $scope.startTimestamp = data[0];
        $scope.endTimestamp = data[1];
        $scope.refreshChartWithDateRange();
      });
    });

  </script>
  <script src="hawkular-charts.js"></script>


</head>
<body ng-app="myApp">

<h3>Hawkular Charts - Response Time Sample</h3>

<p>
  This page demonstrates the various types of Hawkular charts, and allows to change some of the properties to see how
  these chart types would look with various properties set.
  </p>
<h4>Check out the following list for other examples:</h4>
<ul>
<li><a href="./avail-test.html">Availability Tester</a> </li>
<li><a href="./metrics-chart-sample.html">Metrics Chart Sample</a> </li>
<li><a href="./multi-chart-sample.html">Multi-Chart Sample</a> </li>
</ul>

<p style="font-style: italic">
  Also, be sure to drag on the chart to select interesting areas to zoom in on. This example has all of charts
  responding to the change in zoom area.
</p>

<div ng-controller="ChartController">

  <label for="alertValue">Alert Threshold: </label>
  <input id="alertValue" type="number" step="500" ng-model="alertThreshold"/>
  <label for="dataPoints">Data Points: </label>
  <input id="dataPoints" type="number" step="10" max="120" min="10" ng-model="dataPoints"/>
  <label for="highLowValues">Hide High/Low Values: </label>
  <input id="highLowValues" type="checkbox" ng-model="hideHighLowValues"/>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: HawkularMetric:</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="hawkularmetric"
      alert-value="{{alertThreshold}}"
      show-data-points="true"
      y-axis-units="Response Time (ms)"
      >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: HawkularLine:</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="line"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: Area</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="area"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: Histogram</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="histogram"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      hide-high-low-values="hideHighLowValues"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: RhqBar</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="rhqbar"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: Scatter</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="scatter"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      hide-high-low-values="hideHighLowValues"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

  <div class="metricIdHeader"><span class="metricIdLabel"> ChartType: ScatterLine</span>
  </div>
  <div class="chartWrapper">
    <hawkular-chart
      data="myData"
      chart-type="scatterline"
      alert-value="{{alertThreshold}}"
      use-zero-min-value="true"
      hide-high-low-values="hideHighLowValues"
      y-axis-units="Response Time (ms)" >
    </hawkular-chart>
  </div>

</div>

</body>
</html>
