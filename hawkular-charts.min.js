angular.module("hawkular.charts",[]);var Charts;!function(t){"use strict";function a(t,a,n){var e=d3.svg.line().interpolate("monotone").x(function(a){return t(a.timestamp)}).y(function(t){return a(n)});return e}function n(t,n,e,r,i,o){var s=t.selectAll("path.alertLine").data([r]);s.attr("class",o).attr("d",a(n,e,i)),s.enter().append("path").attr("class",o).attr("d",a(n,e,i)),s.exit().remove()}function e(t,a){function n(t,a){var n,e=[];return t.forEach(function(r,i){0===i&&r.avg>a?e.push(i):(n=t[i-1],r.avg>a&&n&&(!n.avg||n.avg<=a)&&e.push(n.avg?i-1:i))}),e}function e(a,n){var e,r,o,s=[];return a.forEach(function(a){o=t[a];for(var c=a;c<t.length-1;c++)if(e=t[c],r=t[c+1],e.avg>n&&r.avg<=n||e.avg>n&&!r.avg){s.push(new i(o.timestamp,r.avg?r.timestamp:e.timestamp,n));break}}),s.length===a.length-1&&s.push(new i(t[a[a.length-1]].timestamp,t[t.length-1].timestamp,n)),s}var r,o;return o=n(t,a),r=e(o,a)}function r(t,a,n,e,r){function i(t){t.attr("class","alertBounds").attr("x",function(t){return a(t.startTimestamp)}).attr("y",function(){return n(e)}).attr("height",function(t){return 185}).attr("width",function(t){return a(t.endTimestamp)-a(t.startTimestamp)})}var o=t.select("g.alertHolder").selectAll("rect.alertBounds").data(r);o.call(i),o.enter().append("rect").call(i),o.exit().remove()}var i=function(){function t(t,a,n){this.startTimestamp=t,this.endTimestamp=a,this.alertValue=n,this.startDate=new Date(t),this.endDate=new Date(a)}return t}();t.AlertBound=i,t.createAlertLine=n,t.extractAlertRanges=e,t.createAlertBoundsArea=r}(Charts||(Charts={}));var Charts;!function(t){"use strict";var a=angular.module("hawkular.charts"),n=function(){function t(t){this.value=t}return t.prototype.toString=function(){return this.value},t.UP="up",t.DOWN="down",t.UNKNOWN="unknown",t}();t.AvailStatus=n;var e=function(){function t(t,a,n,e,r,i,o){this.start=t,this.end=a,this.value=n,this.startDate=e,this.endDate=r,this.duration=i,this.message=o,this.duration=moment(a).from(moment(t),!0),this.startDate=new Date(t),this.endDate=new Date(a)}return t}();t.TransformedAvailDataPoint=e;var r=function(){function a(r){var i=this;this.restrict="E",this.replace=!0,this.scope={data:"=",startTimestamp:"@",endTimestamp:"@",timeLabel:"@",dateLabel:"@",noDataLabel:"@",chartTitle:"@"},this.link=function(o,s,c){function u(t){return"<div class='chartHover'>\n            <div class=\"info-item\">\n              <span class='chartHoverLabel'>Status:</span>\n              <span class='chartHoverValue'>"+t.value.toUpperCase()+"</span>\n            </div>\n            <div class=\"info-item before-separator\">\n              <span class='chartHoverLabel'>Duration:</span>\n              <span class='chartHoverValue'>"+t.duration+"</span>\n            </div>\n          </div>"}function l(){E&&k.selectAll("*").remove(),k=d3.select(s[0]),E=k.append("svg").attr("viewBox","0 0 760 150").attr("preserveAspectRatio","xMinYMin meet"),H=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t){return u(t)}),S=E.append("g").attr("width",_+R.left+R.right).attr("height",F).attr("transform","translate("+R.left+","+G+")"),S.append("defs").append("pattern").attr("id","diagonal-stripes").attr("patternUnits","userSpaceOnUse").attr("patternTransform","scale(0.7)").attr("width",4).attr("height",4).append("path").attr("d","M-1,1 l2,-2 M0,4 l4,-4 M3,5 l2,-2").attr("stroke","#B6B6B6").attr("stroke-width",1.2),S.call(H)}function m(a){var n=[];b=+c.startTimestamp||d3.min(a,function(t){return t.start})||+moment().subtract(1,"hour"),a&&a.length>0&&(n[0]=b,n[1]=M||+moment(),y=d3.scale.linear().clamp(!0).rangeRound([70,0]).domain([0,175]),w=d3.svg.axis().scale(y).ticks(0).tickSize(0,0).orient("left"),A=d3.time.scale().range([0,_]).domain(n),C=d3.svg.axis().scale(A).tickSize(-70,0).orient("top").tickFormat(t.xAxisTimeFormats()))}function f(t){return t.value===n.UP.toString()}function d(t){return t.value===n.UNKNOWN.toString()}function p(t){function a(t,a){return t.timestamp<a.timestamp?-1:t.timestamp>a.timestamp?1:0}var r=[],i=t.length;if(t.sort(a),t&&i>0&&t[0].timestamp){var o=(new Date).getTime();if(1===i){var s=t[0];r.push(new e(o-36e5,s.timestamp,n.UNKNOWN.toString())),r.push(new e(s.timestamp,o,s.value))}else for(var c=o,u=t.length;u>0;u--){if(b>=t[u-1].timestamp){r.push(new e(b,c,t[u-1].value));break}r.push(new e(t[u-1].timestamp,c,t[u-1].value)),c=t[u-1].timestamp}}return r}function h(){S.append("text").attr("class","availUpLabel").attr("x",-10).attr("y",25).style("font-family","Arial, Verdana, sans-serif;").style("font-size","12px").attr("fill","#999").style("text-anchor","end").text("Up"),S.append("text").attr("class","availDownLabel").attr("x",-10).attr("y",55).style("font-family","Arial, Verdana, sans-serif;").style("font-size","12px").attr("fill","#999").style("text-anchor","end").text("Down")}function v(t){function a(t){return N-o(0)+(f(t)||d(t)?0:35)}function n(t){return o(0)-(d(t)?15:50)}function e(t){return f(t)?"#54A24E":d(t)?"url(#diagonal-stripes)":"#D85054"}var r=(d3.min(t,function(t){return+t.start}),d3.max(t,function(t){return+t.end})),i=d3.time.scale().range([0,_]).domain([b,M||r]),o=d3.scale.linear().clamp(!0).range([N,0]).domain([0,4]);d3.svg.axis().scale(i).ticks(8).tickSize(13,0).orient("top");S.selectAll("rect.availBars").data(t).enter().append("rect").attr("class","availBars").attr("x",function(t){return i(+t.start)}).attr("y",function(t){return a(t)}).attr("height",function(t){return n(t)}).attr("width",function(t){var a=M?Math.min(+t.end,M):+t.end;return i(a)-i(+t.start)}).attr("fill",function(t){return e(t)}).attr("opacity",function(){return.85}).on("mouseover",function(t,a){H.show(t,a)}).on("mouseout",function(){H.hide()}).on("mousedown",function(){var t=S.select(".brush").node(),a=new Event("mousedown");a.pageX=d3.event.pageX,a.clientX=d3.event.clientX,a.pageY=d3.event.pageY,a.clientY=d3.event.clientY,t.dispatchEvent(a)}).on("mouseup",function(){var t=S.select(".brush").node(),a=new Event("mouseup");a.pageX=d3.event.pageX,a.clientX=d3.event.clientX,a.pageY=d3.event.pageY,a.clientY=d3.event.clientY,t.dispatchEvent(a)}),S.append("line").attr("x1",0).attr("y1",70).attr("x2",655).attr("y2",70).attr("stroke-width",.5).attr("stroke","#D0D0D0"),h()}function g(){S.selectAll("g.axis").remove(),D=S.append("g").attr("class","x axis").call(C),S.append("g").attr("class","y axis").call(w)}function x(){function a(){S.classed("selecting",!0)}function n(){var a=T.extent(),n=Math.round(a[0].getTime()),e=Math.round(a[1].getTime()),i=e-n;i>=6e4&&r.$broadcast(t.EventNames.AVAIL_CHART_TIMERANGE_CHANGED.toString(),a),P.call(T.clear())}T=d3.svg.brush().x(A).on("brushstart",a).on("brushend",n),P=S.append("g").attr("class","brush").call(T),P.selectAll(".resize").append("path"),P.selectAll("rect").attr("height",70)}var y,A,w,C,D,T,P,H,E,k,S,b=+c.startTimestamp,M=+c.endTimestamp,L=a._CHART_HEIGHT,R=(c.noDataLabel||"No Data",{top:10,right:5,bottom:5,left:90}),_=a._CHART_WIDTH-R.left-R.right,I=L-50,N=I-R.top-R.bottom,V=30,B=10,F=N+R.top-V-B,G=+V+B+R.top;o.$watchCollection("data",function(t){t&&(i.transformedDataPoints=p(angular.fromJson(t)),o.render(i.transformedDataPoints))}),o.$watchGroup(["startTimestamp","endTimestamp"],function(t){b=+t[0]||b,M=+t[1]||M,o.render(i.transformedDataPoints)}),o.render=function(t){t&&t.length>0&&(l(),m(t),g(),x(),v(t))}}}return a.Factory=function(){var t=function(t){return new a(t)};return t.$inject=["$rootScope"],t},a._CHART_HEIGHT=150,a._CHART_WIDTH=750,a}();t.AvailabilityChartDirective=r,a.directive("availabilityChart",r.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict";var a=angular.module("hawkular.charts"),n=function(){function a(n){var e=this;this.restrict="E",this.replace=!0,this.scope={data:"=",showYAxisValues:"="},this.link=function(r,i,o){function s(){A&&w.selectAll("*").remove(),w=d3.select(i[0]),A=w.append("svg").attr("width",P+D.left+D.right).attr("height",E).attr("viewBox","0 0 760 50").attr("preserveAspectRatio","xMinYMin meet"),C=A.append("g").attr("transform","translate("+D.left+", 0)").attr("class","contextChart")}function c(n){h=d3.time.scale().range([0,P-10]).nice().domain([n[0].timestamp,n[n.length-1].timestamp]),v=d3.svg.axis().scale(h).ticks(5).tickSize(4,0).tickFormat(t.xAxisTimeFormats()).orient("bottom"),C.selectAll("g.axis").remove(),g=C.append("g").attr("class","x axis").attr("transform","translate(0,"+H+")").call(v);var e=d3.min(n,function(t){return t.avg}),r=d3.max(n,function(t){return t.avg});r+=.03*r,e-=.05*e,f=d3.scale.linear().rangeRound([a._CHART_HEIGHT-10,0]).nice().domain([e,r]);var i=m?2:0;d=d3.svg.axis().scale(f).ticks(i).tickSize(4,0).orient("left"),p=C.append("g").attr("class","y axis").call(d);var o=d3.svg.area().interpolate("cardinal").defined(function(t){return!t.empty}).x(function(t){return h(t.timestamp)}).y0(function(t){return H}).y1(function(t){return f(t.avg)}),s=d3.svg.line().interpolate("cardinal").defined(function(t){return!t.empty}).x(function(t){return h(t.timestamp)}).y(function(t){return f(t.avg)}),c=C.selectAll("path.contextLine").data([n]);c.attr("class","contextLine").transition().attr("d",s),c.enter().append("path").attr("class","contextLine").transition().attr("d",s),c.exit().remove();var u=C.append("g").attr("class","context");u.append("path").datum(n).transition().duration(500).attr("class","contextArea").attr("d",o)}function u(){function a(){C.classed("selecting",!0)}function e(){var a=x.extent(),e=Math.round(a[0].getTime()),r=Math.round(a[1].getTime()),i=r-e;i>=6e4&&n.$broadcast(t.EventNames.CONTEXT_CHART_TIMERANGE_CHANGED.toString(),a)}x=d3.svg.brush().x(h).on("brushstart",a).on("brushend",e),g.append("g").selectAll("rect").attr("y",0).attr("height",H-10),y=C.append("g").attr("class","brush").call(x),y.selectAll(".resize").append("path"),y.selectAll("rect").attr("height",H+17)}function l(t){return t?t.map(function(t){var a=t.timestamp||t.start+(t.end-t.start)/2;return{timestamp:a,value:angular.isNumber(t.value)?t.value:void 0,avg:t.empty?void 0:t.avg,min:angular.isNumber(t.min)?t.min:void 0,max:angular.isNumber(t.max)?t.max:void 0,empty:t.empty}}):void 0}var m,f,d,p,h,v,g,x,y,A,w,C,D={top:0,right:5,bottom:5,left:90},T=a._CHART_HEIGHT,P=a._CHART_WIDTH-D.left-D.right,H=T-D.top-D.bottom,E=H+D.top;"undefined"!=typeof o.showYAxisValues&&(m="true"===o.showYAxisValues),r.$watchCollection("data",function(t){t&&(e.dataPoints=l(angular.fromJson(t)),r.render(e.dataPoints))}),r.render=function(t){t&&t.length>0&&(s(),c(t),u())}}}return a.Factory=function(){var t=function(t){return new a(t)};return t.$inject=["$rootScope"],t},a._CHART_WIDTH=750,a._CHART_HEIGHT=50,a}();t.ContextChartDirective=n,a.directive("hawkularContextChart",n.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict";var a=function(){function t(t){this.value=t}return t.prototype.toString=function(){return this.value},t.CHART_TIMERANGE_CHANGED=new t("ChartTimeRangeChanged"),t.AVAIL_CHART_TIMERANGE_CHANGED=new t("AvailChartTimeRangeChanged"),t.CONTEXT_CHART_TIMERANGE_CHANGED=new t("ContextChartTimeRangeChanged"),t}();t.EventNames=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(t,a,n,e,r){var i=1,o=t.selectAll(".dataPointDot").data(r);o.attr("class","dataPointDot").attr("r",i).attr("cx",function(t){return a(t.timestamp)}).attr("cy",function(t){return t.avg?n(t.avg):-9999999}).on("mouseover",function(t,a){e.show(t,a)}).on("mouseout",function(){e.hide()}),o.enter().append("circle").attr("class","dataPointDot").attr("r",i).attr("cx",function(t){return a(t.timestamp)}).attr("cy",function(t){return t.avg?n(t.avg):-9999999}).on("mouseover",function(t,a){e.show(t,a)}).on("mouseout",function(){e.hide()}),o.exit().remove()}t.createDataPoints=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";var a=!1;t.DEFAULT_Y_SCALE=10,t.Y_AXIS_HEIGHT=25,t.CHART_HEIGHT=250,t.CHART_WIDTH=750,t.HOVER_DATE_TIME_FORMAT="MM/DD/YYYY h:mm a",t.BAR_OFFSET=2,t.margin={top:10,right:5,bottom:5,left:90},t.width=t.CHART_WIDTH-t.margin.left-t.margin.right,angular.module("hawkular.charts").directive("hawkularChart",["$rootScope","$http","$interval","$log",function(n,e,r,i){function o(o,s,c){function u(){return t.CHART_WIDTH}function l(){return u()<=Tt}function m(){U&&Y.selectAll("*").remove(),Y=d3.select(s[0]),U=Y.append("svg").attr("viewBox","0 0 760 "+(t.CHART_HEIGHT+t.Y_AXIS_HEIGHT)).attr("preserveAspectRatio","xMinYMin meet"),t.createSvgDefs(U),O=U.append("g").attr("width",t.width+t.margin.left+t.margin.right).attr("height",Et).attr("transform","translate("+t.margin.left+","+kt+")"),F=d3.tip().attr("class","d3-tip").offset([-10,0]).html(function(t,a){return x(t,a)}),O.call(F),O.append("g").attr("class","alertHolder"),St=!0}function f(a){a&&(z=d3.max(a.map(function(a){return t.isEmptyDataPoint(a)?0:a.avg||a.value})),J=d3.min(a.map(function(a){return t.isEmptyDataPoint(a)?void 0:a.avg||a.value}))),X=wt?0:.95*J,W=z+.2*(z-J),rt&&(W=Math.max(W,1.2*rt),X=Math.min(X,.95*rt)),W=W||X?W:t.DEFAULT_Y_SCALE}function d(a){var n,e=20;if(a.length>0){l()?(t.width=250,n=3,_=a.slice(a.length-e,a.length)):(n=9,_=a),f(a),I=d3.scale.linear().clamp(!0).rangeRound([Dt,0]).domain([X,W]),V=d3.svg.axis().scale(I).ticks(5).tickSize(4,4,0).orient("left");var r,i=d3.min(a.map(function(t){return t.timestamp}));r=R&&R.length>0?R[R.length-1].timestamp:d3.max(a.map(function(t){return t.timestamp})),N=d3.time.scale().range([0,t.width]).domain([i,r]),B=d3.svg.axis().scale(N).ticks(n).tickFormat(t.xAxisTimeFormats()).tickSize(4,4,0).orient("bottom")}}function p(a){function n(){var n,e,r,i,o=[],s=[];return a.forEach(function(a){n=d3.max(a.values.map(function(a){return t.isEmptyDataPoint(a)?0:a.avg})),o.push(n),e=d3.min(a.values.map(function(a){return t.isEmptyDataPoint(a)?Number.MAX_VALUE:a.avg})),s.push(e)}),r=d3.max(o),i=d3.min(s),[i,r]}var e,r,i=n();return z=i[1],J=i[0],X=wt?0:J-.05*J,rt?(e=1.2*rt,r=z+.2*(z-J),W=e>r?e:r):W=z+.2*(z-J),[X,W||X?W:t.DEFAULT_Y_SCALE]}function h(a){var n=9;if(a&&a[0]&&a[0].values){var e=p(a);X=e[0],W=e[1],I=d3.scale.linear().clamp(!0).rangeRound([Dt,0]).domain([X,W]),V=d3.svg.axis().scale(I).ticks(5).tickSize(4,4,0).orient("left"),N=d3.time.scale().range([0,t.width]).domain([d3.min(a,function(t){return d3.min(t.values,function(t){return t.timestamp})}),d3.max(a,function(t){return d3.max(t.values,function(t){return t.timestamp})})]),B=d3.svg.axis().scale(N).ticks(n).tickFormat(t.xAxisTimeFormats()).tickSize(4,4,0).orient("bottom")}}function v(t,a,n,r,s){void 0===s&&(s=60);var c={headers:{"Hawkular-Tenant":tt},params:{start:n,end:r,buckets:s}};if(n>=r&&i.log("Start date was after end date"),t&&at&&a){var u=at.split("-");e.get(t+"/"+u[0]+"s/"+a+"/"+(u[1]||"data"),c).success(function(t){j=g(t),o.render(j,K)}).error(function(t,a){i.error("Error Loading Chart Data:"+a+", "+t)})}}function g(t){return t?t.map(function(t){var a=t.timestamp||t.start+(t.end-t.start)/2;return{timestamp:a,date:new Date(a),value:angular.isNumber(t.value)?t.value:void 0,avg:t.empty?void 0:t.avg,min:angular.isNumber(t.min)?t.min:void 0,max:angular.isNumber(t.max)?t.max:void 0,empty:t.empty}}):void 0}function x(a,n){var e,r,i,o=a.timestamp,s=moment(a.timestamp).format(t.HOVER_DATE_TIME_FORMAT);return n>0&&(r=_[n-1].timestamp,i=moment(o).from(moment(r),!0)),e=t.isEmptyDataPoint(a)?"<div class='chartHover'>\n                <small class='chartHoverLabel'>"+ft+"</small>\n                <div><small><span class='chartHoverLabel'>"+dt+"</span><span>: </span><span class='chartHoverValue'>"+i+"</span></small> </div>\n                <hr/>\n                <div><small><span class='chartHoverLabel'>"+gt+"</span><span>: </span><span class='chartHoverValue'>"+s+"</span></small></div>\n                </div>":t.isRawMetric(a)?"<div class='chartHover'>\n                <div><small><span class='chartHoverLabel'>"+gt+"</span><span>: </span><span class='chartHoverValue'>"+s+"</span></small></div>\n                  <div><small><span class='chartHoverLabel'>"+dt+"</span><span>: </span><span class='chartHoverValue'>"+i+"</span></small></div>\n                  <hr/>\n                  <div><small><span class='chartHoverLabel'>"+mt+"</span><span>: </span><span class='chartHoverValue'>"+d3.round(a.value,2)+"</span></small> </div>\n                  </div> ":"<div class='chartHover'>\n                    <div class=\"info-item\">\n                      <span class='chartHoverLabel'>"+gt+":</span>\n                      <span class='chartHoverValue'>"+s+"</span>\n                    </div>\n                    <div class=\"info-item before-separator\">\n                      <span class='chartHoverLabel'>"+dt+":</span>\n                      <span class='chartHoverValue'>"+i+"</span>\n                    </div>\n                    <div class=\"info-item separator\">\n                      <span class='chartHoverLabel'>"+ht+":</span>\n                      <span class='chartHoverValue'>"+d3.round(a.max,2)+"</span>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class='chartHoverLabel'>"+vt+":</span>\n                      <span class='chartHoverValue'>"+d3.round(a.avg,2)+"</span>\n                    </div>\n                    <div class=\"info-item\">\n                      <span class='chartHoverLabel'>"+pt+":</span>\n                      <span class='chartHoverValue'>"+d3.round(a.min,2)+"</span>\n                    </div>\n                  </div> "}function y(a){var n=d3.scale.category10(),e=0;a?(O.selectAll("path[id^='multiLine']")[0].forEach(function(n){var e=!1;a.forEach(function(a){a.keyHash=a.keyHash||"multiLine"+t.hashString(a.key),n.getAttribute("id")===a.keyHash&&(e=!0)}),e||n.remove()}),a.forEach(function(a){if(a&&a.values){a.keyHash=a.keyHash||"multiLine"+t.hashString(a.key);var r=O.selectAll("path#"+a.keyHash).data([a.values]);r.attr("id",a.keyHash).attr("class","multiLine").attr("fill","none").attr("stroke",function(){return a.color||n(e++)}).transition().attr("d",D("linear")),r.enter().append("path").attr("id",a.keyHash).attr("class","multiLine").attr("fill","none").attr("stroke",function(){return a.color?a.color:n(e++)}).transition().attr("d",D("linear")),r.exit().remove()}})):i.warn("No multi-data set for multiline chart")}function A(){if(I){var a=O.selectAll("g.grid.y_grid");a[0].length||(a=O.append("g").classed("grid y_grid",!0)),a.call(d3.svg.axis().scale(I).orient("left").ticks(10).tickSize(-t.width,0).tickFormat(""))}}function w(){function a(t){t.transition().delay(250).duration(750).attr("opacity",1)}if(V){O.selectAll("g.axis").remove();var n=(O.append("g").attr("class","x axis").attr("transform","translate(0,"+Dt+")").attr("opacity",.3).call(B).call(a),O.append("g").attr("class","y axis").attr("opacity",.3).call(V).call(a),O.selectAll(".yAxisUnitsLabel"));n.empty()&&(n=O.append("text").attr("class","yAxisUnitsLabel").attr("transform","rotate(-90),translate(-10,-50)").attr("x",-t.CHART_HEIGHT/2).style("text-anchor","start").text("NONE"===c.yAxisUnits?"":c.yAxisUnits).attr("opacity",.3).call(a))}}function C(a){var n=a||"monotone",e=d3.svg.line().interpolate(n).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return N(t.timestamp)}).y(function(a){return I(t.isRawMetric(a)?a.value:a.avg)});return e}function D(a){var n=a||"monotone",e=d3.svg.line().interpolate(n).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return N(t.timestamp)}).y(function(a){return I(t.isRawMetric(a)?a.value:a.avg)});return e}function T(){if("bar"===lt||"scatterline"===lt){var t=O.selectAll(".barAvgLine").data([_]);t.attr("class","barAvgLine").attr("d",C("monotone")),t.enter().append("path").attr("class","barAvgLine").attr("d",C("monotone")),t.exit().remove()}}function P(){function a(){O.classed("selecting",!0)}function e(){var a=G.extent(),e=Math.round(a[0].getTime()),r=Math.round(a[1].getTime()),i=r-e;O.classed("selecting",!d3.event.target.empty()),i>=6e4&&(R=[],S(R),n.$broadcast(t.EventNames.CHART_TIMERANGE_CHANGED.toString(),a)),$.call(G.clear())}$=O.selectAll("g.brush"),$.empty()&&($=O.append("g").attr("class","brush")),G=d3.svg.brush().x(N).on("brushstart",a).on("brushend",e),$.call(G),$.selectAll(".resize").append("path"),$.selectAll("rect").attr("height",Dt)}function H(t){t&&O.append("path").datum(t).attr("class","prevRangeAvgLine").style("stroke-dasharray","9,3").attr("d",C("linear"))}function E(t){t&&O.selectAll(".annotationDot").data(t).enter().append("circle").attr("class","annotationDot").attr("r",5).attr("cx",function(t){return N(t.timestamp)}).attr("cy",function(){return Dt-I(W)}).style("fill",function(t){return"1"===t.severity?"red":"2"===t.severity?"yellow":"white"})}function k(t){var a=t||"monotone",n=d3.svg.line().interpolate(a).x(function(t){return N(t.timestamp)}).y(function(t){return I(t.value)});return n}function S(t){var a=O.selectAll(".forecastLine").data([t]);a.attr("class","forecastLine").attr("d",k("monotone")),a.enter().append("path").attr("class","forecastLine").attr("d",k("monotone")),a.exit().remove()}function b(){ot=Date.now(),st=moment().subtract(nt,"seconds").valueOf(),v(Z,Q,st,ot,60)}function M(a){switch(a){case"rhqbar":t.createHistogramChart(O,N,I,_,F,Dt,!0,W,At);break;case"histogram":t.createHistogramChart(O,N,I,_,F,Dt,!1,W,At);break;case"line":t.createLineChart(O,N,I,_,Dt,it);break;case"hawkularmetric":i.info("DEPRECATION WARNING: The chart type hawkularmetric has been deprecated and will be removed in a future release. Please use the line chart type in its place"),t.createLineChart(O,N,I,_,Dt,it);break;case"multiline":y(L);break;case"area":t.createAreaChart(O,N,I,_,Dt,it,At);break;case"scatter":t.createScatterChart(O,N,I,_,Dt,it,At);break;case"scatterline":t.createScatterLineChart(O,N,I,_,Dt,it,At);break;default:i.warn("chart-type is not valid. Must be in [rhqbar,line,area,multiline,scatter,scatterline,histogram] chart type: "+a)}}var L,R,_,I,N,V,B,F,G,$,U,Y,O,X,W,z,J,j,K,q=[],Z=c.metricUrl,Q=c.metricId||"",tt=c.metricTenantId||"",at=c.metricType||"gauge",nt=+c.timeRangeInSeconds||43200,et=+c.refreshIntervalInSeconds||3600,rt=+c.alertValue,it=c.interpolation||"monotone",ot=Date.now(),st=ot-nt,ct=[],ut=[],lt=c.chartType||"line",mt=c.singleValueLabel||"Raw Value",ft=c.noDataLabel||"No Data",dt=c.durationLabel||"Interval",pt=c.minLabel||"Min",ht=c.maxLabel||"Max",vt=c.avgLabel||"Avg",gt=c.timestampLabel||"Timestamp",xt=!0,yt=!1,At=!1,wt=!1,Ct=t.CHART_HEIGHT-50,Dt=Ct-t.margin.top-t.margin.bottom,Tt=600,Pt=30,Ht=10,Et=Dt+t.margin.top-Pt-Ht+t.margin.bottom,kt=+Pt+Ht+t.margin.top,St=!1;q=c.data,R=c.forecastData,yt=c.showDataPoints,ct=c.previousRangeData,ut=c.annotationData;var bt;o.$watchCollection("data",function(t){t&&(j=angular.fromJson(t),o.render(j,K))}),o.$watch("multiData",function(t){t&&(L=angular.fromJson(t),o.render(j,K))},!0),o.$watch("previousRangeData",function(t){t&&(K=angular.fromJson(t),o.render(j,K))},!0),o.$watch("annotationData",function(t){t&&(ut=angular.fromJson(t),o.render(j,K))},!0),o.$watch("forecastData",function(t){t&&(R=angular.fromJson(t),o.render(j,K))},!0),o.$watchGroup(["alertValue","chartType","hideHighLowValues","useZeroMinValue","showAvgLine"],function(t){rt=t[0]||rt,lt=t[1]||lt,At="undefined"!=typeof t[2]?t[2]:At,wt="undefined"!=typeof t[3]?t[3]:wt,xt="undefined"!=typeof t[4]?t[4]:xt,o.render(j,K)}),o.$watchGroup(["metricUrl","metricId","metricType","metricTenantId","timeRangeInSeconds"],function(t){Z=t[0]||Z,Q=t[1]||Q,at=t[2]||Q,tt=t[3]||tt,nt=t[4]||nt,b()}),o.$watch("refreshIntervalInSeconds",function(t){t&&(et=+t,r.cancel(bt),bt=r(function(){b()},1e3*et))}),o.$on("$destroy",function(){r.cancel(bt)}),o.$on("DateRangeDragChanged",function(t,a){o.$emit("GraphTimeRangeChangedEvent",a)}),o.render=function(n,e){if(n||L){if(a&&console.group("Render Chart"),a&&console.time("chartRender"),St||m(),n&&d(n),L&&h(L),rt&&rt>X&&W>rt){var r=t.extractAlertRanges(_,rt);t.createAlertBoundsArea(O,N,I,W,r)}P(),A(),M(lt),yt&&t.createDataPoints(O,N,I,F,_),H(e),w(),xt&&T(),rt&&rt>X&&W>rt&&t.createAlertLine(O,N,I,_,rt,"alertLine"),ut&&E(ut),R&&R.length>0&&S(R),a&&console.timeEnd("chartRender"),a&&console.groupEnd("Render Chart")}}}return{link:o,restrict:"E",replace:!0,scope:{data:"=",multiData:"=",forecastData:"=",metricUrl:"@",metricId:"@",metricType:"@",metricTenantId:"@",startTimestamp:"@",endTimestamp:"@",timeRangeInSeconds:"@",refreshIntervalInSeconds:"@",previousRangeData:"@",annotationData:"@",showDataPoints:"=",alertValue:"@",interpolation:"@",chartType:"@",yAxisUnits:"@",useZeroMinValue:"=",chartHoverDateFormat:"@",chartHoverTimeFormat:"@",singleValueLabel:"@",noDataLabel:"@",durationLabel:"@",minLabel:"@",maxLabel:"@",avgLabel:"@",timestampLabel:"@",showAvgLine:"=",hideHighLowValues:"="}}}])}(Charts||(Charts={}));var Charts;!function(t){"use strict";var a=15,n=angular.module("hawkular.charts"),e=function(){function n(e){var r=this;this.restrict="E",this.replace=!0,this.scope={data:"=",showYAxisValues:"=",showXAxisValues:"=",alertValue:"@"},this.link=function(e,i,o){function s(){x&&y.selectAll("*").remove(),y=d3.select(i[0]),x=y.append("svg").attr("width",T+C.left+C.right).attr("height",H).attr("viewBox","0 0 "+(T+C.left+C.right)+" "+(P+C.top+C.bottom+a)).attr("preserveAspectRatio","xMinYMin meet"),A=x.append("g").attr("transform","translate("+C.left+","+C.top+")").attr("class","sparkline")}function c(e){h=d3.time.scale().range([0,T-10]).nice().domain([e[0].timestamp,e[e.length-1].timestamp]);var r=l?2:0;v=d3.svg.axis().scale(h).ticks(r).tickSize(4,0).tickFormat(t.xAxisTimeFormats()).orient("bottom"),A.selectAll("g.axis").remove();var i=d3.min(e,function(t){return t.avg}),o=d3.max(e,function(t){return t.avg});o+=.03*o,i-=.05*i,f=d3.scale.linear().rangeRound([n._CHART_HEIGHT-a,0]).domain([i,o]);var s=m?2:0;d=d3.svg.axis().scale(f).ticks(s).tickSize(3,0).orient("left");var c="basis",u=d3.svg.area().interpolate(c).defined(function(t){return!t.empty}).x(function(t){return h(t.timestamp)}).y0(function(t){return n._CHART_HEIGHT-a}).y1(function(t){return f(t.avg)}),x=d3.svg.line().interpolate(c).defined(function(t){return!t.empty}).x(function(t){return h(t.timestamp)}).y(function(t){return f(t.avg)-2}),y=A.selectAll("path.sparklineLine").data([e]);y.attr("class","sparklineLine").transition().attr("d",x),y.enter().append("path").attr("class","sparklineLine").transition().attr("d",x),y.exit().remove();var C=A.append("g").attr("class","sparkline");C.append("path").datum(e).transition().duration(500).attr("class","sparklineArea").attr("d",u),p=A.append("g").attr("class","y axis").call(d),g=A.append("g").attr("class","x axis").attr("transform","translate(0,"+P+")").call(v),w&&w>=i&&o>=w&&t.createAlertLine(A,h,f,e,w,"sparklineAlertLine")}function u(t){return t?t.map(function(t){var a=t.timestamp||t.start+(t.end-t.start)/2;return{timestamp:a,value:angular.isNumber(t.value)?t.value:void 0,avg:t.empty?void 0:t.avg,min:angular.isNumber(t.min)?t.min:void 0,max:angular.isNumber(t.max)?t.max:void 0,empty:t.empty}}):void 0}var l,m,f,d,p,h,v,g,x,y,A,w,C={top:10,right:5,bottom:5,left:45},D=n._CHART_HEIGHT,T=n._CHART_WIDTH-C.left-C.right,P=D-C.top-C.bottom,H=P+C.top;"undefined"!=typeof o.alertValue&&(w=+o.alertValue),"undefined"!=typeof o.showXAxisValues&&(l="true"===o.showXAxisValues),"undefined"!=typeof o.showYAxisValues&&(m="true"===o.showYAxisValues),e.$watchCollection("data",function(t){t&&(r.dataPoints=u(angular.fromJson(t)),e.render(r.dataPoints))}),e.$watchCollection("alertValue",function(t){t&&(w=t,r.dataPoints&&e.render(r.dataPoints))}),e.render=function(t){t&&t.length>0&&(s(),c(t))}}}return n.Factory=function(){var t=function(t){return new n(t)};return t.$inject=["$rootScope"],t},n._CHART_WIDTH=300,n._CHART_HEIGHT=80,n}();t.SparklineChartDirective=e,n.directive("hawkularSparklineChart",e.Factory())}(Charts||(Charts={}));var Charts;!function(t){"use strict"}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e){return void 0===e&&(e=t.BAR_OFFSET),a/n-e}function n(n,e){return 0===n||n===e-1?a(t.width,e,t.BAR_OFFSET)/2:a(t.width,e,t.BAR_OFFSET)}function e(n,e,r,i){return r(n.timestamp)-(0===e?0:a(t.width,i,t.BAR_OFFSET)/2)}function r(t){return t.empty}function i(t){return"undefined"==typeof t.avg}function o(){return d3.time.format.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%H:%M",function(t){return t.getMinutes()}],["%H:%M",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",function(){return!0}]])}function s(t){var a=t.append("defs");a.append("pattern").attr("id","noDataStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").append("path").attr("d","M 0 0 6 0").attr("style","stroke:#CCCCCC; fill:none;"),a.append("pattern").attr("id","unknownStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").attr("style","stroke:#2E9EC2; fill:none;").append("path").attr("d","M 0 0 6 0"),a.append("pattern").attr("id","downStripes").attr("patternUnits","userSpaceOnUse").attr("x","0").attr("y","0").attr("width","6").attr("height","3").attr("style","stroke:#ff8a9a; fill:none;").append("path").attr("d","M 0 0 6 0")}function c(t,a){return a(t.timestamp)}function u(t){var a,n,e,r=0;if(0==t.length)return r;for(a=0,e=t.length;e>a;a++)n=t.charCodeAt(a),r=(r<<5)-r+n,r|=0;return r}t.calcBarWidth=a,t.calcBarWidthAdjusted=n,t.calcBarXPos=e,t.isEmptyDataPoint=r,t.isRawMetric=i,t.xAxisTimeFormats=o,t.createSvgDefs=s,t.xMidPointStartPosition=c,t.hashString=u}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e,r,i,o,s){var c=d3.svg.area().interpolate(o).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return n(t)}).y(function(a){return e(t.isRawMetric(a)?a.value:a.max)}).y0(function(a){return e(t.isRawMetric(a)?a.value:a.avg)}),u=d3.svg.area().interpolate(o).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return n(t)}).y(function(a){return e(t.isRawMetric(a)?a.value:a.avg)}).y0(function(t){return s?i:e(t.min)}),l=d3.svg.area().interpolate(o).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return n(t)}).y(function(a){return e(t.isRawMetric(a)?a.value:a.min)}).y0(function(){return i});if(!s){var m=a.selectAll("path.highArea").data(r);m.attr("class","highArea").attr("d",c),m.enter().append("path").attr("class","highArea").attr("d",c),m.exit().remove();var f=a.selectAll("path.lowArea").data(r);f.attr("class","lowArea").attr("d",l),f.enter().append("path").attr("class","lowArea").attr("d",l),f.exit().remove()}var d=a.selectAll("path.avgArea").data(r);d.attr("class","avgArea").attr("d",u),d.enter().append("path").attr("class","avgArea").attr("d",u),d.exit().remove()}t.createAreaChart=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e,r,i,o,s,c,u){function l(a){a.attr("class",x).on("mouseover",function(t,a){i.show(t,a)}).on("mouseout",function(){i.hide()}).transition().attr("x",function(a,e){return t.calcBarXPos(a,e,n,r.length)}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,r.length)}).attr("y",function(a){return t.isEmptyDataPoint(a)?0:e(a.avg)}).attr("height",function(a){return o-e(t.isEmptyDataPoint(a)?e(c):a.avg)}).attr("opacity",s?".6":"1").attr("fill",function(a,n){return t.isEmptyDataPoint(a)?"url(#noDataStripes)":s?"#D3D3D6":"#C0C0C0"}).attr("stroke",function(t){return"#777"}).attr("stroke-width",function(t){return"0"}).attr("data-hawkular-value",function(t){return t.avg})}function m(a){a.attr("class",function(t){return t.min===t.max?"singleValue":"high"}).attr("x",function(a,e){return t.calcBarXPos(a,e,n,r.length)}).attr("y",function(t){return e(isNaN(t.max)?c:t.max)}).attr("height",function(a){return t.isEmptyDataPoint(a)?0:e(a.avg)-e(a.max)||2}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,r.length)}).attr("opacity",.9).on("mouseover",function(t,a){i.show(t,a)}).on("mouseout",function(){i.hide();
})}function f(a){a.attr("class","low").attr("x",function(a,e){return t.calcBarXPos(a,e,n,r.length)}).attr("y",function(t){return isNaN(t.avg)?o:e(t.avg)}).attr("height",function(a){return t.isEmptyDataPoint(a)?0:e(a.min)-e(a.avg)}).attr("width",function(a,n){return t.calcBarWidthAdjusted(n,r.length)}).attr("opacity",.9).on("mouseover",function(t,a){i.show(t,a)}).on("mouseout",function(){i.hide()})}function d(a){a.attr("class","histogramTopStem").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.avg)}).attr("stroke",function(t){return"red"}).attr("stroke-opacity",function(t){return.6})}function p(a){a.filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","histogramBottomStem").attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.avg)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"red"}).attr("stroke-opacity",function(t){return.6})}function h(a){a.filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","histogramTopCross").attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.max)}).attr("stroke",function(t){return"red"}).attr("stroke-width",function(t){return"0.5"}).attr("stroke-opacity",function(t){return.6})}function v(a){a.filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","histogramBottomCross").attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.min)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"red"}).attr("stroke-width",function(t){return"0.5"}).attr("stroke-opacity",function(t){return.6})}function g(t,a,n){if(n){var e=t.selectAll("rect.high, rect.singleValue").data(a);e.call(m),e.enter().append("rect").call(m),e.exit().remove();var r=t.selectAll("rect.low").data(a);r.call(f),r.enter().append("rect").call(f),r.exit().remove()}else{var i=t.selectAll(".histogramTopStem").data(a);i.call(d),i.enter().append("line").call(d),i.exit().remove();var o=t.selectAll(".histogramBottomStem").data(a);o.call(p),o.enter().append("line").call(p),o.exit().remove();var s=t.selectAll(".histogramTopCross").data(a);s.call(h),s.enter().append("line").call(h),s.exit().remove();var c=t.selectAll(".histogramBottomCross").data(a);c.call(v),c.enter().append("line").call(v),c.exit().remove()}}var x=s?"leaderBar":"histogram",y=a.selectAll("rect."+x).data(r);y.call(l),y.enter().append("rect").call(l),y.exit().remove(),u?a.selectAll(".histogramTopStem, .histogramBottomStem, .histogramTopCross, .histogramBottomCross").remove():g(a,r,s)}t.createHistogramChart=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e,r,i,o){var s=d3.svg.line().interpolate(o).defined(function(a){return!t.isEmptyDataPoint(a)}).x(function(t){return n(t.timestamp)}).y(function(a){return e(t.isRawMetric(a)?a.value:a.avg)}),c=a.selectAll("path.metricLine").data([r]);c.attr("class","metricLine").transition().attr("d",s),c.enter().append("path").attr("class","metricLine").transition().attr("d",s),c.exit().remove()}t.createLineChart=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e,r,i,o,s){if(s)a.selectAll(".highDot, .lowDot").remove();else{var c=a.selectAll(".highDot").data(r);c.attr("class","highDot").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.max)}).style("fill",function(){return"#ff1a13"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),c.enter().append("circle").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","highDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.max)}).style("fill",function(){return"#ff1a13"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),c.exit().remove();var u=a.selectAll(".lowDot").data(r);u.attr("class","lowDot").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.min)}).style("fill",function(){return"#70c4e2"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),u.enter().append("circle").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","lowDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.min)}).style("fill",function(){return"#70c4e2"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),u.exit().remove()}var l=a.selectAll(".avgDot").data(r);l.attr("class","avgDot").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.avg)}).style("fill",function(){return"#FFF"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),l.enter().append("circle").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","avgDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.avg)}).style("fill",function(){return"#FFF"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),l.exit().remove()}t.createScatterChart=a}(Charts||(Charts={}));var Charts;!function(t){"use strict";function a(a,n,e,r,i,o,s){var c=a.selectAll(".scatterLineTopStem").data(r);c.attr("class","scatterLineTopStem").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.avg)}).attr("stroke",function(t){return"#000"}),c.enter().append("line").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","scatterLineTopStem").attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.avg)}).attr("stroke",function(t){return"#000"}),c.exit().remove();var u=a.selectAll(".scatterLineBottomStem").data(r);u.attr("class","scatterLineBottomStem").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.avg)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"#000"}),u.enter().append("line").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","scatterLineBottomStem").attr("x1",function(a){return t.xMidPointStartPosition(a,n)}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)}).attr("y1",function(t){return e(t.avg)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"#000"}),u.exit().remove();var l=a.selectAll(".scatterLineTopCross").data(r);l.attr("class","scatterLineTopCross").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.max)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),l.enter().append("line").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","scatterLineTopCross").attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.max)}).attr("y2",function(t){return e(t.max)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),l.exit().remove();var m=a.selectAll(".scatterLineBottomCross").data(r);m.attr("class","scatterLineBottomCross").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.min)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),m.enter().append("line").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","scatterLineBottomCross").attr("x1",function(a){return t.xMidPointStartPosition(a,n)-3}).attr("x2",function(a){return t.xMidPointStartPosition(a,n)+3}).attr("y1",function(t){return e(t.min)}).attr("y2",function(t){return e(t.min)}).attr("stroke",function(t){return"#000"}).attr("stroke-width",function(t){return"0.5"}),m.exit().remove();var f=a.selectAll(".scatterDot").data(r);f.attr("class","scatterDot").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.avg)}).style("fill",function(){return"#70c4e2"}).style("opacity",function(){return"1"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),f.enter().append("circle").filter(function(a){return!t.isEmptyDataPoint(a)}).attr("class","scatterDot").attr("r",3).attr("cx",function(a){return t.xMidPointStartPosition(a,n)}).attr("cy",function(a){return e(t.isRawMetric(a)?a.value:a.avg)}).style("fill",function(){return"#70c4e2"}).style("opacity",function(){return"1"}).on("mouseover",function(t,a){}).on("mouseout",function(){}),f.exit().remove()}t.createScatterLineChart=a}(Charts||(Charts={}));